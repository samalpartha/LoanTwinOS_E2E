(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[210],{4433:function(e,n,t){Promise.resolve().then(t.bind(t,1038))},1038:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return o}});var a=t(7437),r=t(2265),s=t(6463),c=t(6264);function i(){let e=Number((0,s.useSearchParams)().get("loanId")||1),[n,t]=(0,r.useState)(""),[i,o]=(0,r.useState)([]),[l,u]=(0,r.useState)(!0),[d,h]=(0,r.useState)(!1),[f,m]=(0,r.useState)(""),[p,x]=(0,r.useState)(null),[y,v]=(0,r.useState)(20),[g,b]=(0,r.useState)({}),[j,N]=(0,r.useState)(null),[w,S]=(0,r.useState)(""),[T,C]=(0,r.useState)(!1),[k,P]=(0,r.useState)(null),[E,L]=(0,r.useState)(1);async function O(n){m(""),h(!!n);try{let[t,a]=await Promise.all([(0,c.Jr)(e,n&&n.length?n:void 0),(0,c.Rr)(e)]);o(t),a&&a.length>0&&P(a[0].id),v(20)}catch(e){m(e.message||String(e))}finally{u(!1),h(!1)}}(0,r.useEffect)(()=>{O()},[e]);let R=()=>O(n),D=(e,n)=>n?e.split(RegExp("(".concat(n,")"),"gi")).map((e,t)=>e.toLowerCase()===n.toLowerCase()?(0,a.jsx)("mark",{style:{background:"var(--accent-warning-dim)",color:"var(--accent-warning)",padding:"0 2px",borderRadius:2},children:e},t):e):e,_=e=>{L(e),C(!0)},A=e=>{w.trim()&&(b({...g,[e]:[...g[e]||[],w]}),S(""),N(null))};return l?(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"loading-overlay",children:[(0,a.jsx)("div",{className:"spinner"}),(0,a.jsx)("span",{children:"Loading clauses..."})]})}):f?(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"empty-state",children:[(0,a.jsx)("div",{style:{fontSize:40,marginBottom:16},children:"\uD83D\uDD0D"}),(0,a.jsx)("div",{className:"h2",children:"Unable to Load Clauses"}),(0,a.jsx)("p",{className:"small",children:f}),(0,a.jsx)("button",{className:"btn primary mt-md",onClick:()=>O(),children:"Retry Connection"})]})}):(0,a.jsxs)("div",{className:"slide-up ".concat(T?"split-view":""),style:{display:"flex",gap:24,height:T?"calc(100vh - 250px)":"auto"},children:[(0,a.jsxs)("div",{style:{flex:1,overflowY:T?"auto":"visible",paddingRight:T?12:0},children:[(0,a.jsxs)("div",{className:"card mb-md",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"h2",children:"Clause Explorer"}),(0,a.jsx)("h2",{className:"h3 mt-sm",children:"Search & Browse Agreement Clauses"})]}),k&&(0,a.jsx)("button",{className:"btn ".concat(T?"primary":""),onClick:()=>C(!T),children:T?"Close PDF":"View PDF Source"})]}),(0,a.jsxs)("div",{className:"search-box mt-lg",children:[(0,a.jsx)("input",{className:"input",placeholder:"Search clauses...",value:n,onChange:e=>t(e.target.value),onKeyPress:e=>"Enter"===e.key&&R()}),(0,a.jsx)("button",{className:"btn primary",onClick:R,disabled:d,children:d?"...":"Search"})]})]}),(0,a.jsx)("div",{className:"card",children:0===i.length?(0,a.jsx)("div",{className:"empty-state",children:"No clauses found."}):(0,a.jsxs)("div",{className:"flex-col gap-md",style:{display:"flex"},children:[i.slice(0,y).map(e=>{var t;return(0,a.jsxs)("div",{className:"clause-card ".concat(p===e.id?"active":""),children:[(0,a.jsxs)("div",{className:"clause-header",children:[(0,a.jsx)("div",{className:"clause-title",children:n?D(e.heading,n):e.heading}),(0,a.jsxs)("div",{className:"flex gap-sm",children:[(0,a.jsxs)("button",{className:"tag primary",onClick:()=>_(e.page_start),style:{cursor:"pointer"},children:["p. ",e.page_start]}),(0,a.jsx)("button",{className:"btn-icon btn",onClick:()=>N(j===e.id?null:e.id),children:"\uD83D\uDCAC"}),(0,a.jsx)("button",{className:"btn-icon btn",onClick:()=>x(p===e.id?null:e.id),children:p===e.id?"âˆ’":"+"})]})]}),(0,a.jsx)("div",{className:"clause-body",style:{maxHeight:p===e.id?"none":"80px",overflow:"hidden"},children:n?D(e.body,n):e.body}),(j===e.id||g[e.id]&&g[e.id].length>0)&&(0,a.jsxs)("div",{className:"mt-md pt-md",style:{borderTop:"1px solid var(--border-subtle)"},children:[null===(t=g[e.id])||void 0===t?void 0:t.map((e,n)=>(0,a.jsxs)("div",{className:"small mb-sm",style:{padding:"8px 12px",background:"var(--bg-primary)",borderRadius:"var(--radius-sm)"},children:[(0,a.jsx)("span",{style:{fontWeight:600,color:"var(--accent-primary)"},children:"Legal Team:"})," ",e]},n)),j===e.id&&(0,a.jsxs)("div",{className:"flex gap-sm mt-sm",children:[(0,a.jsx)("input",{className:"input",style:{padding:"8px 12px",fontSize:12},placeholder:"Add a comment...",value:w,onChange:e=>S(e.target.value),onKeyPress:n=>"Enter"===n.key&&A(e.id)}),(0,a.jsx)("button",{className:"btn success",style:{padding:"8px 12px"},onClick:()=>A(e.id),children:"Post"})]})]})]},e.id)}),y<i.length&&(0,a.jsx)("button",{className:"btn mt-lg",onClick:()=>v(e=>e+20),children:"Load More"})]})})]}),T&&k&&(0,a.jsxs)("div",{className:"card slide-up",style:{flex:1,display:"flex",flexDirection:"column",padding:0,overflow:"hidden",border:"1px solid var(--accent-primary)"},children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",style:{padding:"12px 16px",background:"var(--bg-secondary)",borderBottom:"1px solid var(--border-subtle)"},children:[(0,a.jsx)("span",{className:"h2",style:{margin:0},children:"Human-in-the-Loop Verification"}),(0,a.jsx)("button",{className:"btn-icon btn",onClick:()=>C(!1),children:"\xd7"})]}),(0,a.jsx)("iframe",{src:"".concat((0,c.uF)(k),"#page=").concat(E),style:{width:"100%",height:"100%",border:"none"}})]})]})}function o(){return(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)("div",{className:"card",children:"Loading..."}),children:(0,a.jsx)(i,{})})}},6264:function(e,n,t){"use strict";t.d(n,{CM:function(){return p},DC:function(){return x},Jr:function(){return m},Qc:function(){return c},R5:function(){return i},RH:function(){return u},Rr:function(){return d},Rt:function(){return v},dp:function(){return h},tX:function(){return s},uF:function(){return y},x4:function(){return o},xc:function(){return f},z2:function(){return l}});let a=t(357).env.NEXT_PUBLIC_API_BASE||"http://127.0.0.1:8010";async function r(e){if(!e.ok)throw Error(await e.text()||e.statusText);return e.json()}async function s(e){return r(await fetch("".concat(a,"/api/loans"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e})}))}async function c(){return r(await fetch("".concat(a,"/api/loans/sample"),{method:"POST"}))}async function i(e,n,t){return r(await fetch("".concat(a,"/api/auth/social-login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_name:e,email:n,social_provider:t})}))}async function o(e,n){return r(await fetch("".concat(a,"/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:n})}))}async function l(e,n,t){return r(await fetch("".concat(a,"/api/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_name:e,email:n,password:t})}))}async function u(e,n){let t=new FormData;return t.append("file",n),r(await fetch("".concat(a,"/api/loans/").concat(e,"/documents"),{method:"POST",body:t}))}async function d(e){return r(await fetch("".concat(a,"/api/loans/").concat(e,"/documents")))}async function h(e,n){return r(await fetch("".concat(a,"/api/loans/").concat(e,"/process-document/").concat(n),{method:"POST"}))}async function f(e){return r(await fetch("".concat(a,"/api/loans/").concat(e,"/dlr")))}async function m(e,n){let t=n?"?query=".concat(encodeURIComponent(n)):"";return r(await fetch("".concat(a,"/api/loans/").concat(e,"/clauses").concat(t)))}async function p(e){return r(await fetch("".concat(a,"/api/loans/").concat(e,"/obligations")))}async function x(e){return r(await fetch("".concat(a,"/api/loans/").concat(e,"/trade-pack")))}function y(e){return"".concat(a,"/api/documents/").concat(e,"/file")}async function v(){try{return(await fetch("".concat(a,"/api/health"))).ok}catch(e){return!1}}},6463:function(e,n,t){"use strict";var a=t(1169);t.o(a,"usePathname")&&t.d(n,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(n,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(n,{useSearchParams:function(){return a.useSearchParams}})},357:function(e,n,t){"use strict";var a,r;e.exports=(null==(a=t.g.process)?void 0:a.env)&&"object"==typeof(null==(r=t.g.process)?void 0:r.env)?t.g.process:t(8081)},8081:function(e){!function(){var n={229:function(e){var n,t,a,r=e.exports={};function s(){throw Error("setTimeout has not been defined")}function c(){throw Error("clearTimeout has not been defined")}function i(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{t="function"==typeof clearTimeout?clearTimeout:c}catch(e){t=c}}();var o=[],l=!1,u=-1;function d(){l&&a&&(l=!1,a.length?o=a.concat(o):u=-1,o.length&&h())}function h(){if(!l){var e=i(d);l=!0;for(var n=o.length;n;){for(a=o,o=[];++u<n;)a&&a[u].run();u=-1,n=o.length}a=null,l=!1,function(e){if(t===clearTimeout)return clearTimeout(e);if((t===c||!t)&&clearTimeout)return t=clearTimeout,clearTimeout(e);try{t(e)}catch(n){try{return t.call(null,e)}catch(n){return t.call(this,e)}}}(e)}}function f(e,n){this.fun=e,this.array=n}function m(){}r.nextTick=function(e){var n=Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)n[t-1]=arguments[t];o.push(new f(e,n)),1!==o.length||l||i(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(e){return[]},r.binding=function(e){throw Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw Error("process.chdir is not supported")},r.umask=function(){return 0}}},t={};function a(e){var r=t[e];if(void 0!==r)return r.exports;var s=t[e]={exports:{}},c=!0;try{n[e](s,s.exports,a),c=!1}finally{c&&delete t[e]}return s.exports}a.ab="//";var r=a(229);e.exports=r}()}},function(e){e.O(0,[971,23,744],function(){return e(e.s=4433)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{496:function(e,t,n){Promise.resolve().then(n.bind(n,1982))},1982:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return u}});var a=n(7437);n(4332);var s=n(7138),i=n(6463),r=n(2265);function l(){let[e,t]=(0,r.useState)(!1),[n,s]=(0,r.useState)([{role:"ai",text:"Hello! I am your Deal Assistant. How can I help you analyze this deal set today?"}]),[i,l]=(0,r.useState)(""),c=(0,r.useRef)(null);(0,r.useEffect)(()=>{c.current&&(c.current.scrollTop=c.current.scrollHeight)},[n]);let o=()=>{if(!i.trim())return;let e={role:"user",text:i};s(t=>[...t,e]),l(""),setTimeout(()=>{let e="I've analyzed the Deal Set. Could you be more specific? I can answer questions about covenants, cure periods, or assignments.";i.toLowerCase().includes("leverage")&&(e="The Net Leverage covenant is defined in Section 7.02. The current limit is 4.0x, with a step-down to 3.5x after Year 2."),i.toLowerCase().includes("cure")&&(e="According to Section 8.01, there is a 5-business day cure period for payment defaults and a 30-day period for other covenant breaches."),s(t=>[...t,{role:"ai",text:e}])},800)};return(0,a.jsx)("div",{style:{position:"fixed",bottom:30,right:30,zIndex:1e3},children:e?(0,a.jsxs)("div",{className:"card",style:{width:350,height:500,display:"flex",flexDirection:"column",padding:0,boxShadow:"0 10px 40px rgba(0,0,0,0.4)",border:"1px solid var(--accent-primary)"},children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",style:{padding:"12px 16px",background:"var(--bg-secondary)",borderBottom:"1px solid var(--border-subtle)"},children:[(0,a.jsx)("span",{style:{fontWeight:600},children:"\uD83D\uDCAC Deal Assistant"}),(0,a.jsx)("button",{className:"btn-icon btn",onClick:()=>t(!1),children:"\xd7"})]}),(0,a.jsx)("div",{ref:c,style:{flex:1,overflowY:"auto",padding:16,display:"flex",flexDirection:"column",gap:12},children:n.map((e,t)=>(0,a.jsx)("div",{style:{alignSelf:"ai"===e.role?"flex-start":"flex-end",maxWidth:"85%"},children:(0,a.jsx)("div",{className:"small ".concat("ai"===e.role?"card-inner":"pill active"),style:{padding:"8px 12px",borderRadius:12,background:"ai"===e.role?"var(--bg-elevated)":"var(--accent-primary)",color:"ai"===e.role?"var(--text-primary)":"white"},children:e.text})},t))}),(0,a.jsxs)("div",{className:"flex gap-sm",style:{padding:12,borderTop:"1px solid var(--border-subtle)"},children:[(0,a.jsx)("input",{className:"input",style:{padding:"8px 12px",fontSize:13},placeholder:"Ask about this deal...",value:i,onChange:e=>l(e.target.value),onKeyPress:e=>"Enter"===e.key&&o()}),(0,a.jsx)("button",{className:"btn primary",style:{padding:"8px 12px"},onClick:o,children:"Send"})]})]}):(0,a.jsx)("button",{className:"btn primary",style:{borderRadius:"50%",width:60,height:60,fontSize:24,boxShadow:"0 8px 24px rgba(59, 130, 246, 0.4)"},onClick:()=>t(!0),children:"\uD83D\uDCAC"})})}var c=n(6264);let o=e=>{let{user:t,theme:n,toggleTheme:l}=e,[o,d]=(0,r.useState)(null);(0,r.useEffect)(()=>{(0,c.Rt)().then(d);let e=setInterval(()=>(0,c.Rt)().then(d),1e4);return()=>clearInterval(e)},[]);let u=(0,i.usePathname)(),p=(0,i.useSearchParams)().get("loanId")||"1",h=e=>"/"===e?"/"===u:u.startsWith(e.split("?")[0]);return(0,a.jsxs)("nav",{className:"nav",children:[[{href:"/",label:"Workspace",icon:"◈"},{href:"/dlr?loanId=".concat(p),label:"DLR",icon:"◉"},{href:"/clauses?loanId=".concat(p),label:"Clause Explorer",icon:"◎"},{href:"/obligations?loanId=".concat(p),label:"Obligations",icon:"◐"},{href:"/trade-pack?loanId=".concat(p),label:"Trade Pack",icon:"◑"}].map(e=>(0,a.jsx)(s.default,{href:e.href,children:(0,a.jsxs)("span",{className:"pill ".concat(h(e.href)?"active":""),children:[(0,a.jsx)("span",{style:{marginRight:6,opacity:.7},children:e.icon}),e.label]})},e.href)),(0,a.jsxs)("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:12},children:[!1===o&&(0,a.jsx)("span",{className:"tag danger",style:{fontSize:10,animation:"pulse 2s infinite"},children:"● API Offline"}),(0,a.jsx)("button",{className:"btn-icon btn",onClick:l,title:"Toggle Theme",children:"dark"===n?"☀️":"\uD83C\uDF19"}),t?(0,a.jsxs)(s.default,{href:"/profile",className:"flex items-center gap-sm",children:[t.picture_url&&(0,a.jsx)("img",{src:t.picture_url,alt:"",style:{width:32,height:32,borderRadius:"50%",border:"1px solid var(--border-accent)"}}),(0,a.jsx)("span",{className:"small mono",style:{color:"var(--accent-primary)"},children:t.full_name?t.full_name.split(" ")[0]:"User"})]}):(0,a.jsx)(s.default,{href:"/login",className:"btn primary",style:{padding:"6px 12px",fontSize:12},children:"Login"})]})]})},d=e=>{let{isOpen:t,onClose:n}=e,[s,l]=(0,r.useState)(""),c=(0,i.useRouter)();return((0,r.useEffect)(()=>{let e=e=>{(e.metaKey||e.ctrlKey)&&"k"===e.key&&(e.preventDefault(),n())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[n]),t)?(0,a.jsx)("div",{style:{position:"fixed",inset:0,zIndex:1e3,display:"flex",alignItems:"flex-start",justifyContent:"center",paddingTop:"15vh",background:"rgba(0,0,0,0.6)",backdropFilter:"blur(4px)"},onClick:n,children:(0,a.jsxs)("div",{className:"card",style:{width:500,padding:8,boxShadow:"0 20px 50px rgba(0,0,0,0.5)",border:"1px solid var(--accent-primary)"},onClick:e=>e.stopPropagation(),children:[(0,a.jsx)("input",{autoFocus:!0,className:"input",placeholder:"Type a command or search... (Cmd+K)",value:s,onChange:e=>l(e.target.value),style:{border:"none",background:"transparent",fontSize:18,width:"100%"}}),(0,a.jsx)("div",{className:"divider",style:{margin:"8px 0"}}),(0,a.jsx)("div",{className:"flex-col gap-sm",style:{display:"flex"},children:[{name:"Jump to Workspace",cmd:"/",icon:"◈"},{name:"Search Clauses",cmd:"/clauses",icon:"◎"},{name:"View Obligations",cmd:"/obligations",icon:"◐"},{name:"Export to Excel",cmd:"export",icon:"\uD83D\uDCE5"},{name:"Toggle Theme",cmd:"theme",icon:"\uD83C\uDF19"}].filter(e=>e.name.toLowerCase().includes(s.toLowerCase())).map(e=>(0,a.jsxs)("div",{className:"pill",style:{display:"flex",justifyContent:"space-between",cursor:"pointer",borderRadius:"var(--radius-md)"},onClick:()=>{e.cmd.startsWith("/")&&c.push(e.cmd),n()},children:[(0,a.jsxs)("span",{children:[e.icon," ",e.name]}),(0,a.jsx)("span",{className:"small mono",style:{opacity:.5},children:e.cmd})]},e.name))})]})}):null};function u(e){let{children:t}=e,[n,s]=(0,r.useState)(null),[i,c]=(0,r.useState)("dark"),[u,p]=(0,r.useState)(!1),[h,m]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{m(!0);let e=localStorage.getItem("loantwin_user");if(e)try{s(JSON.parse(e))}catch(e){console.error("Failed to parse user from localStorage")}let t=localStorage.getItem("loantwin_theme");t&&c(t);let n=e=>{(e.metaKey||e.ctrlKey)&&"k"===e.key&&(e.preventDefault(),p(e=>!e))};return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[]),(0,a.jsxs)("html",{lang:"en",className:h&&"light"===i?"theme-light":"",children:[(0,a.jsxs)("head",{children:[(0,a.jsx)("title",{children:"LoanTwin OS"}),(0,a.jsx)("meta",{name:"description",content:"Deal Operating System for Institutional Finance"})]}),(0,a.jsxs)("body",{children:[(0,a.jsxs)("div",{className:"container",children:[(0,a.jsx)("header",{style:{marginBottom:8},children:(0,a.jsx)("div",{className:"flex items-center gap-md",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"h1",children:["LoanTwin OS ",(0,a.jsx)("span",{style:{fontSize:12,opacity:.5,verticalAlign:"middle"},children:"Enterprise"})]}),(0,a.jsx)("p",{className:"subtitle",children:"Institutional Deal Operating System"})]})})}),h?(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)("div",{className:"nav",children:(0,a.jsx)("span",{className:"pill",children:"Loading..."})}),children:(0,a.jsx)(o,{user:n,theme:i,toggleTheme:()=>{let e="dark"===i?"light":"dark";c(e),localStorage.setItem("loantwin_theme",e)}})}):(0,a.jsx)("div",{className:"nav",children:(0,a.jsx)("span",{className:"pill",children:"Initializing..."})}),(0,a.jsx)("main",{children:t}),(0,a.jsx)("footer",{style:{marginTop:40,paddingTop:24,borderTop:"1px solid var(--border-subtle)"},children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("p",{className:"small",style:{opacity:.6},children:"LoanTwin OS — v2.5 Enterprise"}),(0,a.jsx)("div",{className:"flex gap-md",children:(0,a.jsxs)("span",{className:"small mono",children:["Press ",(0,a.jsx)("kbd",{style:{padding:"2px 4px",background:"var(--bg-elevated)",borderRadius:4},children:"Cmd+K"})," for Command Palette"]})})]})})]}),(0,a.jsx)(d,{isOpen:u,onClose:()=>p(!1)}),(0,a.jsx)(l,{})]})]})}},6264:function(e,t,n){"use strict";n.d(t,{CM:function(){return f},DC:function(){return x},Jr:function(){return m},Qc:function(){return r},R5:function(){return l},RH:function(){return d},Rr:function(){return u},Rt:function(){return g},dp:function(){return p},tX:function(){return i},uF:function(){return y},x4:function(){return c},xc:function(){return h},z2:function(){return o}});let a=n(357).env.NEXT_PUBLIC_API_BASE||"http://127.0.0.1:8010";async function s(e){if(!e.ok)throw Error(await e.text()||e.statusText);return e.json()}async function i(e){return s(await fetch("".concat(a,"/api/loans"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e})}))}async function r(){return s(await fetch("".concat(a,"/api/loans/sample"),{method:"POST"}))}async function l(e,t,n){return s(await fetch("".concat(a,"/api/auth/social-login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_name:e,email:t,social_provider:n})}))}async function c(e,t){return s(await fetch("".concat(a,"/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}))}async function o(e,t,n){return s(await fetch("".concat(a,"/api/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_name:e,email:t,password:n})}))}async function d(e,t){let n=new FormData;return n.append("file",t),s(await fetch("".concat(a,"/api/loans/").concat(e,"/documents"),{method:"POST",body:n}))}async function u(e){return s(await fetch("".concat(a,"/api/loans/").concat(e,"/documents")))}async function p(e,t){return s(await fetch("".concat(a,"/api/loans/").concat(e,"/process-document/").concat(t),{method:"POST"}))}async function h(e){return s(await fetch("".concat(a,"/api/loans/").concat(e,"/dlr")))}async function m(e,t){let n=t?"?query=".concat(encodeURIComponent(t)):"";return s(await fetch("".concat(a,"/api/loans/").concat(e,"/clauses").concat(n)))}async function f(e){return s(await fetch("".concat(a,"/api/loans/").concat(e,"/obligations")))}async function x(e){return s(await fetch("".concat(a,"/api/loans/").concat(e,"/trade-pack")))}function y(e){return"".concat(a,"/api/documents/").concat(e,"/file")}async function g(){try{return(await fetch("".concat(a,"/api/health"))).ok}catch(e){return!1}}},4332:function(){}},function(e){e.O(0,[228,718,971,23,744],function(){return e(e.s=496)}),_N_E=e.O()}]);
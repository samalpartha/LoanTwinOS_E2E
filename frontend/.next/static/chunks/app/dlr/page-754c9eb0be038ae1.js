(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[253],{9468:function(e,n,t){Promise.resolve().then(t.bind(t,8718))},8718:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return u}});var s=t(7437),a=t(2265),c=t(6463),i=t(6264);function r(e){let{logs:n}=e;return n&&0!==n.length?(0,s.jsxs)("div",{className:"card mt-md",children:[(0,s.jsx)("div",{className:"h2 mb-md",children:"Deal Audit Trail"}),(0,s.jsx)("div",{className:"flex-col gap-sm",style:{display:"flex"},children:n.map((e,n)=>(0,s.jsxs)("div",{className:"small card-inner flex justify-between",children:[(0,s.jsxs)("span",{children:[(0,s.jsx)("span",{style:{fontWeight:600,color:"var(--accent-primary)"},children:e.user||"System"})," ",e.action,": ",e.details]}),(0,s.jsx)("span",{className:"mono opacity-50",children:new Date(e.timestamp).toLocaleString()})]},n))})]}):null}function l(e){let{score:n}=e;if(!n)return null;let t=n>95?"success":n>85?"warning":"danger";return(0,s.jsxs)("span",{className:"tag ".concat(t),style:{fontSize:10,padding:"2px 6px",marginLeft:8},children:[n,"% Confidence"]})}function o(e){let{covenants:n}=e,[t,c]=(0,a.useState)({});if(!n||0===n.length)return null;let i=(e,n)=>e.toLowerCase().includes("leverage")?n<4:!e.toLowerCase().includes("cover")||n>2.5;return(0,s.jsxs)("div",{className:"card mt-md",style:{border:"1px solid var(--accent-primary-dim)"},children:[(0,s.jsx)("div",{className:"h2 mb-md",children:"Covenant Compliance Simulator"}),(0,s.jsx)("div",{className:"flex-col gap-md",style:{display:"flex"},children:n.map((e,n)=>(0,s.jsxs)("div",{className:"card-inner",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-sm",children:[(0,s.jsx)("div",{style:{fontWeight:600},children:e.name}),(0,s.jsxs)("div",{className:"tag primary",children:["Target: ",e.threshold]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-md",children:[(0,s.jsx)("div",{className:"form-group",style:{flex:1},children:(0,s.jsx)("input",{type:"number",className:"input",placeholder:"Enter current value...",step:"0.1",onChange:n=>c({...t,[e.name]:parseFloat(n.target.value)})})}),void 0!==t[e.name]&&(0,s.jsx)("div",{className:"status ".concat(i(e.name,t[e.name])?"ready":"error"),style:{minWidth:140},children:i(e.name,t[e.name])?"IN COMPLIANCE":"BREACH"})]})]},n))})]})}function d(){let e=Number((0,c.useSearchParams)().get("loanId")||1),[n,t]=(0,a.useState)(null),[d,u]=(0,a.useState)(!0),[m,h]=(0,a.useState)(""),[x,f]=(0,a.useState)("structured"),[p,j]=(0,a.useState)(!1),[v,y]=(0,a.useState)(null),[g,N]=(0,a.useState)(1),[b,w]=(0,a.useState)([{user:"AI Engine",action:"extracted",details:"Extracted deal terms from Credit Agreement",timestamp:new Date().toISOString()}]);(0,a.useEffect)(()=>{(async()=>{u(!0);try{let[n,s]=await Promise.all([(0,i.xc)(e),(0,i.Rr)(e)]);t(n),s&&s.length>0&&y(s[0].id)}catch(e){h(e.message||String(e))}finally{u(!1)}})()},[e]);let S=e=>{N(e),j(!0)};return d?(0,s.jsx)("div",{className:"card",children:(0,s.jsxs)("div",{className:"loading-overlay",children:[(0,s.jsx)("div",{className:"spinner"}),(0,s.jsx)("span",{children:"Loading Digital Loan Record..."})]})}):m?(0,s.jsx)("div",{className:"card",children:(0,s.jsxs)("div",{className:"empty-state",children:["Unable to load DLR: ",m]})}):n?(0,s.jsxs)("div",{className:"slide-up ".concat(p?"split-view":""),style:{display:"flex",gap:24,height:p?"calc(100vh - 250px)":"auto"},children:[(0,s.jsxs)("div",{style:{flex:1,overflowY:p?"auto":"visible",paddingRight:p?12:0},children:[(0,s.jsxs)("div",{className:"card mb-md",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"h2",children:"Digital Loan Record"}),(0,s.jsxs)("h2",{className:"h3 mt-sm",children:["Loan #",n.loan_id]})]}),(0,s.jsxs)("div",{className:"flex gap-sm",children:[(0,s.jsx)("button",{className:"btn success",onClick:()=>{let t="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(n,null,2)),s=document.createElement("a");s.setAttribute("href",t),s.setAttribute("download","loantwin_dlr_".concat(e,".json")),document.body.appendChild(s),s.click(),s.remove()},children:"\uD83D\uDCE5 Export JSON"}),(0,s.jsx)("button",{className:"btn primary",onClick:()=>alert("Downloading Excel Model Mapper with Amortization Logic..."),children:"\uD83D\uDCC8 Excel Model Mapper"}),v&&(0,s.jsx)("button",{className:"btn ".concat(p?"primary":""),onClick:()=>j(!p),children:p?"Close PDF":"Verify Source"}),(0,s.jsxs)("div",{className:"nav",style:{margin:0,padding:4},children:[(0,s.jsx)("button",{className:"pill ".concat("structured"===x?"active":""),onClick:()=>f("structured"),children:"Details"}),(0,s.jsx)("button",{className:"pill ".concat("analysis"===x?"active":""),onClick:()=>f("analysis"),children:"\uD83D\uDCC8 Analysis"}),(0,s.jsx)("button",{className:"pill ".concat("team"===x?"active":""),onClick:()=>f("team"),children:"\uD83D\uDC65 Team"}),(0,s.jsx)("button",{className:"pill ".concat("json"===x?"active":""),onClick:()=>f("json"),children:"JSON"})]})]})]}),(0,s.jsxs)("div",{className:"kpi mt-lg",children:[(0,s.jsxs)("div",{className:"box accent",children:[(0,s.jsx)("div",{className:"label",children:"Agreement Date"}),(0,s.jsx)("div",{className:"value",children:n.agreement_date||"—"})]}),(0,s.jsxs)("div",{className:"box",children:[(0,s.jsx)("div",{className:"label",children:"Governing Law"}),(0,s.jsxs)("div",{className:"value",style:{fontSize:16},children:[n.governing_law||"—",(0,s.jsx)(l,{score:n.governing_law_confidence})]})]})]})]}),"structured"===x&&(0,s.jsxs)("div",{className:"flex-col gap-md",style:{display:"flex"},children:[(0,s.jsxs)("div",{className:"card",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-md",children:[(0,s.jsx)("div",{className:"dlr-section-title",style:{margin:0},children:"AI Evidence Log (Click to verify)"}),(0,s.jsx)("button",{className:"btn success",style:{padding:"4px 10px",fontSize:11},onClick:()=>w([...b,{user:"Elon Musk",action:"verified",details:"Manually verified Governing Law citation",timestamp:new Date().toISOString()}]),children:"✓ Verify All"})]}),(0,s.jsx)("div",{className:"flex-col gap-sm",style:{display:"flex"},children:n.citations.map((e,n)=>(0,s.jsxs)("div",{className:"dlr-item",onClick:()=>S(e.page_start),style:{cursor:"pointer",borderLeft:"3px solid var(--accent-primary)"},children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"tag primary",children:e.keyword}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(l,{score:e.confidence}),(0,s.jsxs)("span",{className:"small",style:{marginLeft:8},children:["p. ",e.page_start," →"]})]})]}),(0,s.jsx)("div",{className:"small mt-sm",children:e.clause})]},n))})]}),(0,s.jsx)(r,{logs:b})]}),"analysis"===x&&(0,s.jsxs)("div",{className:"flex-col gap-md",style:{display:"flex"},children:[(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("div",{className:"h2 mb-md",children:"Risk Concentration"}),(0,s.jsxs)("div",{className:"flex gap-md",children:[(0,s.jsxs)("div",{className:"card-inner",style:{flex:1,textAlign:"center"},children:[(0,s.jsx)("div",{className:"small mb-sm",children:"Legal Risk"}),(0,s.jsx)("div",{style:{fontSize:24,fontWeight:700,color:"var(--accent-success)"},children:"Low"})]}),(0,s.jsxs)("div",{className:"card-inner",style:{flex:1,textAlign:"center"},children:[(0,s.jsx)("div",{className:"small mb-sm",children:"Transfer Risk"}),(0,s.jsx)("div",{style:{fontSize:24,fontWeight:700,color:"var(--accent-warning)"},children:"Medium"})]}),(0,s.jsxs)("div",{className:"card-inner",style:{flex:1,textAlign:"center"},children:[(0,s.jsx)("div",{className:"small mb-sm",children:"ESG Alignment"}),(0,s.jsx)("div",{style:{fontSize:24,fontWeight:700,color:"var(--accent-primary)"},children:"82%"})]})]})]}),(0,s.jsx)(o,{covenants:n.covenants})]}),"team"===x&&(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("div",{className:"h2 mb-md",children:"Team Assignments"}),(0,s.jsx)("div",{className:"table-wrapper",children:(0,s.jsxs)("table",{className:"table",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Section"}),(0,s.jsx)("th",{children:"Assignee"}),(0,s.jsx)("th",{children:"Priority"}),(0,s.jsx)("th",{children:"Status"})]})}),(0,s.jsxs)("tbody",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Tax Gross Up"}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"tag",children:"Legal Team"})}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"tag danger",children:"High"})}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"tag warning",children:"In Review"})})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"SOFR Transition"}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"tag",children:"Treasury"})}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"tag primary",children:"Med"})}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"tag success",children:"Verified"})})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"KYC/AML"}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"tag",children:"Operations"})}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"tag",children:"Low"})}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"tag",children:"Pending"})})]})]})]})})]}),"json"===x&&(0,s.jsx)("div",{className:"card",children:(0,s.jsx)("pre",{className:"code",children:JSON.stringify(n,null,2)})})]}),p&&v&&(0,s.jsxs)("div",{className:"card slide-up",style:{flex:1,display:"flex",flexDirection:"column",padding:0,overflow:"hidden",border:"1px solid var(--accent-primary)"},children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",style:{padding:"12px 16px",background:"var(--bg-secondary)",borderBottom:"1px solid var(--border-subtle)"},children:[(0,s.jsx)("span",{className:"h2",style:{margin:0},children:"Human-in-the-Loop Verification"}),(0,s.jsx)("button",{className:"btn-icon btn",onClick:()=>j(!1),children:"\xd7"})]}),(0,s.jsx)("iframe",{src:"".concat((0,i.uF)(v),"#page=").concat(g),style:{width:"100%",height:"100%",border:"none"}})]})]}):null}function u(){return(0,s.jsx)(a.Suspense,{fallback:(0,s.jsx)("div",{className:"card",children:"Loading..."}),children:(0,s.jsx)(d,{})})}},6264:function(e,n,t){"use strict";t.d(n,{CM:function(){return f},DC:function(){return p},Jr:function(){return x},Qc:function(){return i},R5:function(){return r},RH:function(){return d},Rr:function(){return u},Rt:function(){return v},dp:function(){return m},tX:function(){return c},uF:function(){return j},x4:function(){return l},xc:function(){return h},z2:function(){return o}});let s=t(357).env.NEXT_PUBLIC_API_BASE||"http://127.0.0.1:8010";async function a(e){if(!e.ok)throw Error(await e.text()||e.statusText);return e.json()}async function c(e){return a(await fetch("".concat(s,"/api/loans"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e})}))}async function i(){return a(await fetch("".concat(s,"/api/loans/sample"),{method:"POST"}))}async function r(e,n,t){return a(await fetch("".concat(s,"/api/auth/social-login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_name:e,email:n,social_provider:t})}))}async function l(e,n){return a(await fetch("".concat(s,"/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:n})}))}async function o(e,n,t){return a(await fetch("".concat(s,"/api/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_name:e,email:n,password:t})}))}async function d(e,n){let t=new FormData;return t.append("file",n),a(await fetch("".concat(s,"/api/loans/").concat(e,"/documents"),{method:"POST",body:t}))}async function u(e){return a(await fetch("".concat(s,"/api/loans/").concat(e,"/documents")))}async function m(e,n){return a(await fetch("".concat(s,"/api/loans/").concat(e,"/process-document/").concat(n),{method:"POST"}))}async function h(e){return a(await fetch("".concat(s,"/api/loans/").concat(e,"/dlr")))}async function x(e,n){let t=n?"?query=".concat(encodeURIComponent(n)):"";return a(await fetch("".concat(s,"/api/loans/").concat(e,"/clauses").concat(t)))}async function f(e){return a(await fetch("".concat(s,"/api/loans/").concat(e,"/obligations")))}async function p(e){return a(await fetch("".concat(s,"/api/loans/").concat(e,"/trade-pack")))}function j(e){return"".concat(s,"/api/documents/").concat(e,"/file")}async function v(){try{return(await fetch("".concat(s,"/api/health"))).ok}catch(e){return!1}}},6463:function(e,n,t){"use strict";var s=t(1169);t.o(s,"usePathname")&&t.d(n,{usePathname:function(){return s.usePathname}}),t.o(s,"useRouter")&&t.d(n,{useRouter:function(){return s.useRouter}}),t.o(s,"useSearchParams")&&t.d(n,{useSearchParams:function(){return s.useSearchParams}})},357:function(e,n,t){"use strict";var s,a;e.exports=(null==(s=t.g.process)?void 0:s.env)&&"object"==typeof(null==(a=t.g.process)?void 0:a.env)?t.g.process:t(8081)},8081:function(e){!function(){var n={229:function(e){var n,t,s,a=e.exports={};function c(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function r(e){if(n===setTimeout)return setTimeout(e,0);if((n===c||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:c}catch(e){n=c}try{t="function"==typeof clearTimeout?clearTimeout:i}catch(e){t=i}}();var l=[],o=!1,d=-1;function u(){o&&s&&(o=!1,s.length?l=s.concat(l):d=-1,l.length&&m())}function m(){if(!o){var e=r(u);o=!0;for(var n=l.length;n;){for(s=l,l=[];++d<n;)s&&s[d].run();d=-1,n=l.length}s=null,o=!1,function(e){if(t===clearTimeout)return clearTimeout(e);if((t===i||!t)&&clearTimeout)return t=clearTimeout,clearTimeout(e);try{t(e)}catch(n){try{return t.call(null,e)}catch(n){return t.call(this,e)}}}(e)}}function h(e,n){this.fun=e,this.array=n}function x(){}a.nextTick=function(e){var n=Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)n[t-1]=arguments[t];l.push(new h(e,n)),1!==l.length||o||r(m)},h.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=x,a.addListener=x,a.once=x,a.off=x,a.removeListener=x,a.removeAllListeners=x,a.emit=x,a.prependListener=x,a.prependOnceListener=x,a.listeners=function(e){return[]},a.binding=function(e){throw Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw Error("process.chdir is not supported")},a.umask=function(){return 0}}},t={};function s(e){var a=t[e];if(void 0!==a)return a.exports;var c=t[e]={exports:{}},i=!0;try{n[e](c,c.exports,s),i=!1}finally{i&&delete t[e]}return c.exports}s.ab="//";var a=s(229);e.exports=a}()}},function(e){e.O(0,[971,23,744],function(){return e(e.s=9468)}),_N_E=e.O()}]);